%grammar nginx
%version 0.0.1

alllines: lines*

lines: script | comment | blanks

block: /- (
  ( key ( - modifier - value )* )
  - LCURLY -
    ( ( assignment ) | block )*
  - RCURLY -
) -/
assignment: / key ( - value )* terminator /
script: ( assignment | block )+

key: / [ WORD SLASH ]+ /
modifier: / EQUAL | TILDE STAR | TILDE | CARET TILDE /
value: / [^\{\}\;\,]+ /
line: / ANY* EOL? /
terminator: / ';' line /
comment: / '#' line /
blanks: /- EOL/
